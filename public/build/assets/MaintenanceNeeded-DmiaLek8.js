import{z as C,u as N,r as v,o as B,b as l,e as t,F as D,h as M,I as S,l as a,t as i,n as I,J as A,i as y,g as L,f as u,H as h,q as V}from"./app-6lUI17Zo.js";const T={class:"content"},$={class:"container-fluid"},z={key:0,class:"text-center py-5"},F={key:1,class:"text-center py-5 text-muted"},H={key:2,class:"row"},q={class:"col-12"},E={class:"card"},G={class:"card-body table-responsive p-0"},J={class:"table table-hover text-nowrap"},R={class:"text-nowrap"},U=["onClick"],j={__name:"MaintenanceNeeded",setup(K){const o=N(),d=v([]),c=v(!0),k=s=>({reported:"badge-danger",on_progress:"badge-warning",handled:"badge-info",done:"badge-success",cancelled:"badge-secondary"})[s]||"badge-light",x=s=>s?new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"}):"-",_=async()=>{c.value=!0;try{d.value=await o.fetchMaintenanceNeeded()}finally{c.value=!1}},w=async s=>{var e,r;try{await o.assignMaintenance(s,{user_id:o.userId}),_()}catch(n){alert("Gagal ambil: "+((r=(e=n.response)==null?void 0:e.data)==null?void 0:r.message))}};return B(_),(s,e)=>{const r=S("router-link");return a(),l("div",T,[t("div",$,[e[5]||(e[5]=t("div",{class:"row mb-2"},[t("div",{class:"col-sm-6"},[t("h1",{class:"m-0"},"Daftar Barang Butuh Maintenance")])],-1)),c.value?(a(),l("div",z,e[0]||(e[0]=[t("i",{class:"fas fa-spinner fa-spin fa-2x text-muted"},null,-1)]))):d.value.length?(a(),l("div",H,[t("div",q,[t("div",E,[t("div",G,[t("table",J,[e[4]||(e[4]=t("thead",null,[t("tr",null,[t("th",null,"Barang"),t("th",null,"No Inv"),t("th",null,"Ruangan"),t("th",null,"Tgl Lapor"),t("th",null,"Masalah"),t("th",null,"Status"),t("th",null,"Aksi")])],-1)),t("tbody",null,[(a(!0),l(D,null,M(d.value,n=>{var b,m,f,g,p;return a(),l("tr",{key:n.id},[t("td",null,i(((m=(b=n.inventory)==null?void 0:b.item)==null?void 0:m.name)??"-"),1),t("td",null,i(((f=n.inventory)==null?void 0:f.inventory_number)??"-"),1),t("td",null,i(((p=(g=n.inventory)==null?void 0:g.room)==null?void 0:p.name)??"-"),1),t("td",null,i(x(n.created_at)),1),t("td",null,i(n.issue_found??"-"),1),t("td",null,[t("span",{class:I(k(n.status))},i(n.status_label),3)]),t("td",R,[u(o).isAdmin||u(o).isHead?(a(),A(r,{key:0,to:`/maintenance/edit/${n.id}`,class:"btn btn-sm btn-warning mr-1"},{default:h(()=>e[2]||(e[2]=[V(" Assign to Staff ",-1)])),_:2,__:[2]},1032,["to"])):y("",!0),u(o).userDivisi==="Umum"&&n.status==="reported"?(a(),l("button",{key:1,class:"btn btn-sm btn-primary mr-1",onClick:O=>w(n.id)}," Ambil ",8,U)):y("",!0),L(r,{to:`/maintenance/${n.id}`,class:"btn btn-sm btn-outline-info",title:"Lihat detail"},{default:h(()=>e[3]||(e[3]=[t("i",{class:"fas fa-eye"},null,-1)])),_:2,__:[3]},1032,["to"])])])}),128))])])])])])])):(a(),l("div",F,e[1]||(e[1]=[t("i",{class:"fas fa-check-circle fa-2x mb-2"},null,-1),t("p",null,"Tidak ada barang yang perlu maintenance.",-1)])))])])}}},Q=C(j,[["__scopeId","data-v-72a748da"]]);export{Q as default};
